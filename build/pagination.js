!function(){"use strict";function e(){document.querySelectorAll(".wp-block-dss-jobbnorge__wrapper").forEach((function(e){const o=e.getAttribute("data-block-instance"),n=e.querySelector("ul.wp-block-dss-jobbnorge[data-attributes]"),r=e.querySelector(".wp-block-dss-jobbnorge__pagination");if(!n||!r)return;const a=n.getAttribute("data-attributes");if(!a)return;let i;try{i=JSON.parse(a)}catch(e){return void console.error("Failed to parse block attributes:",e)}const s=r.querySelector(".wp-block-dss-jobbnorge__pagination-prev"),c=r.querySelector(".wp-block-dss-jobbnorge__pagination-next");s&&!s.disabled&&s.addEventListener("click",(function(n){n.preventDefault(),t(parseInt(this.getAttribute("data-page")),i,e,o)})),c&&!c.disabled&&c.addEventListener("click",(function(n){n.preventDefault(),t(parseInt(this.getAttribute("data-page")),i,e,o)}))}))}function t(t,r,a,i){a.classList.add("wp-block-dss-jobbnorge__loading"),a.querySelectorAll(".wp-block-dss-jobbnorge__pagination button").forEach((function(e){e.disabled=!0}));const s=new FormData;s.append("action","jobbnorge_get_jobs"),s.append("page",t),s.append("attributes",JSON.stringify(r)),s.append("nonce",window.jobbnorgeAjax?.nonce||""),fetch(window.jobbnorgeAjax?.ajaxUrl||window.ajaxurl||"",{method:"POST",body:s}).then((function(e){return e.json()})).then((function(r){if(r.success){a.outerHTML=r.data.html;const n='.wp-block-dss-jobbnorge__wrapper[data-block-instance="'+i+'"]',s=document.querySelector(n);if(s){if(s.hasAttribute("data-no-autoscroll"))return e(),void o(t);const n=s.querySelector(".jobbnorge-pagination-status");if(n){const e=n.textContent;n.textContent="",n.textContent=e}try{const e=s.getBoundingClientRect(),t=window.innerHeight||document.documentElement.clientHeight,o=parseFloat(s.getAttribute("data-autoscroll-threshold")||"0.25"),n=isNaN(o)?.25:o;if(!(e.top>=0&&e.top<t*n)){const t=2*parseFloat(window.getComputedStyle(document.documentElement).fontSize);window.scrollTo({top:window.pageYOffset+e.top-t,behavior:"smooth"})}}catch(e){}}e(),o(t)}else console.error("AJAX request failed:",r.data),n(a,"Failed to load page. Please try again.")})).catch((function(e){console.error("AJAX request error:",e),n(a,"An error occurred while loading the page.")})).finally((function(){a.classList.remove("wp-block-dss-jobbnorge__loading")}))}function o(e){if(window.history.pushState){const t=new URL(window.location);e>1?t.searchParams.set("jobbnorge_page",e):t.searchParams.delete("jobbnorge_page"),window.history.pushState({page:e},"",t)}}function n(e,t){const o=document.createElement("div");o.className="wp-block-dss-jobbnorge__error notice notice-error",o.innerHTML="<p>"+t+"</p>",e.insertBefore(o,e.firstChild),setTimeout((function(){o.parentNode&&o.parentNode.removeChild(o)}),5e3)}document.addEventListener("DOMContentLoaded",(function(){e()})),window.addEventListener("popstate",(function(e){e.state&&e.state.page&&window.location.reload()}))}();